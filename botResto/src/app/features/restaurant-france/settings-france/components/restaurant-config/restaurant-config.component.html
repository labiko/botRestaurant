<!-- Restaurant Configuration Component -->
<div class="restaurant-config-container">


  <!-- Exceptional Closure Card -->
  <ion-card class="exceptional-closure-card">
    <ion-card-header>
      <ion-card-title>
        <ion-icon name="warning" color="warning"></ion-icon>
        Fermeture Exceptionnelle
      </ion-card-title>
      <ion-card-subtitle>
        Fermer temporairement le restaurant (priorit√© sur les horaires)
      </ion-card-subtitle>
    </ion-card-header>
    
    <ion-card-content>
      <form [formGroup]="restaurantForm">
        <div class="exceptional-closure-toggle">
          <div class="closure-info">
            <h3>{{ restaurantForm.get('is_exceptionally_closed')?.value ? 'FERM√â EXCEPTIONNELLEMENT' : 'Ouvert selon horaires' }}</h3>
            <p>{{ restaurantForm.get('is_exceptionally_closed')?.value ? 'Le restaurant est temporairement ferm√©' : 'Suivre les horaires d\'ouverture normaux' }}</p>
          </div>
          <ion-toggle 
            formControlName="is_exceptionally_closed"
            (ionChange)="onToggleExceptionalClosure()"
            [color]="restaurantForm.get('is_exceptionally_closed')?.value ? 'warning' : 'medium'">
          </ion-toggle>
        </div>
      </form>

      <ion-note class="priority-note" *ngIf="restaurantForm.get('is_exceptionally_closed')?.value">
        <ion-icon name="information-circle" color="warning"></ion-icon>
        Cette fermeture a la priorit√© sur les horaires d'ouverture. Le bot affichera "Fermeture exceptionnelle" m√™me pendant les heures d'ouverture.
      </ion-note>
    </ion-card-content>
  </ion-card>

  <!-- Automatic Printing Card -->
  <ion-card class="automatic-printing-card">
    <ion-card-header>
      <ion-card-title>
        <ion-icon name="print" color="tertiary"></ion-icon>
        Impression Automatique
      </ion-card-title>
      <ion-card-subtitle>
        Imprimer automatiquement les tickets √† la confirmation
      </ion-card-subtitle>
    </ion-card-header>

    <ion-card-content>
      <div class="print-toggle-container">
        <div class="print-info">
          <h3>{{ autoPrintEnabled ? 'ACTIV√â' : 'D√âSACTIV√â' }}</h3>
          <p>{{ autoPrintEnabled ? 'Les tickets s\'imprimeront automatiquement' : 'Impression manuelle uniquement' }}</p>
        </div>
        <ion-toggle
          [(ngModel)]="autoPrintEnabled"
          (ionChange)="onToggleAutoPrint()"
          [color]="autoPrintEnabled ? 'success' : 'medium'">
        </ion-toggle>
      </div>

      <ion-note class="print-note" *ngIf="autoPrintEnabled">
        <ion-icon name="information-circle" color="tertiary"></ion-icon>
        Le ticket sera automatiquement imprim√© d√®s que vous confirmez une commande.
      </ion-note>
    </ion-card-content>
  </ion-card>

  <!-- Restaurant Information -->
  <ion-card class="main-content-card">
    <ion-card-header>
      <ion-card-title>
        <ion-icon name="restaurant" color="primary"></ion-icon>
        Informations Restaurant
      </ion-card-title>
    </ion-card-header>
    
    <ion-card-content>
      <form [formGroup]="restaurantForm">
        <div class="form-grid">

          <ion-item fill="outline">
            <ion-label position="stacked">T√©l√©phone *</ion-label>
            <ion-input formControlName="phone" type="tel" placeholder="0612345678 ou 620123456"></ion-input>
          </ion-item>

          <ion-item fill="outline">
            <ion-label position="stacked">WhatsApp *</ion-label>
            <ion-input formControlName="whatsapp_number" type="tel" placeholder="0612345678 ou 620123456"></ion-input>
          </ion-item>

          <ion-item fill="outline">
            <ion-label position="stacked">üöö Frais de livraison (g√©olocalisation)</ion-label>
            <ion-input formControlName="delivery_fee_geolocation" type="number" placeholder="Ex: 5000"></ion-input>
            <ion-note slot="helper">Frais fixes pour les livraisons en mode GPS</ion-note>
          </ion-item>

        </div>

        <div class="form-actions">
          <ion-button expand="block" fill="solid" color="primary" (click)="onSaveRestaurantConfig()">
            <ion-icon name="save" slot="start"></ion-icon>
            Sauvegarder les informations
          </ion-button>
        </div>
      </form>
    </ion-card-content>
  </ion-card>

  <!-- Operating Hours - NOUVELLE VERSION SIMPLE -->
  <ion-card class="main-content-card">
    <ion-card-header>
      <ion-card-title>
        <ion-icon name="time" color="secondary"></ion-icon>
        Horaires d'Ouverture
      </ion-card-title>
    </ion-card-header>
    
    <ion-card-content>
      
      <!-- Templates rapides -->
      <div class="templates-section" style="margin-bottom: 20px;">
        <h4>Templates rapides</h4>
        <div style="display: flex; gap: 8px; flex-wrap: wrap;">
          <ion-button fill="outline" size="small" (click)="applySimpleTemplate('classic')">
            <ion-icon name="restaurant" slot="start"></ion-icon>
            Classique (11h-22h)
          </ion-button>
          <ion-button fill="outline" size="small" (click)="applySimpleTemplate('fastfood')">
            <ion-icon name="fast-food" slot="start"></ion-icon>
            Fast Food (10h-23h)
          </ion-button>
          <ion-button fill="outline" size="small" (click)="applySimpleTemplate('evening')">
            <ion-icon name="wine" slot="start"></ion-icon>
            Soir√©e (18h-2h)
          </ion-button>
        </div>
      </div>

      <!-- Horaires par jour - VERSION SIMPLE QUI FONCTIONNE -->
      <div class="simple-hours-grid">
        
        <div class="day-row" *ngFor="let day of simpleWeekDays" [class.today]="day.isToday">
          
          <!-- Header du jour -->
          <div class="day-header-row">
            <div class="day-info">
              <h3>{{ day.label }}</h3>
              <span *ngIf="day.isToday" class="today-badge">Aujourd'hui</span>
            </div>
            <div class="day-status">
              <ion-toggle 
                [(ngModel)]="day.isOpen" 
                [color]="day.isOpen ? 'success' : 'medium'">
              </ion-toggle>
              <span class="status-text">{{ day.isOpen ? 'Ouvert' : 'Ferm√©' }}</span>
            </div>
          </div>

          <!-- Heures d'ouverture si ouvert -->
          <div *ngIf="day.isOpen" class="day-times">
            <div class="time-inputs">
              <div class="time-group">
                <ion-icon name="sunny" color="warning"></ion-icon>
                <div>
                  <label>Ouverture</label>
                  <ion-input 
                    type="time" 
                    [(ngModel)]="day.opening"
                    fill="outline"
                    style="--background: #f8fafc;">
                  </ion-input>
                </div>
              </div>
              
              <div class="time-group">
                <ion-icon name="moon" color="medium"></ion-icon>
                <div>
                  <label>Fermeture</label>
                  <ion-input 
                    type="time" 
                    [(ngModel)]="day.closing"
                    fill="outline"
                    style="--background: #f8fafc;">
                  </ion-input>
                </div>
              </div>
            </div>
            
            <!-- Dur√©e calcul√©e -->
            <div *ngIf="day.opening && day.closing" class="duration-info">
              <ion-chip color="tertiary" fill="outline">
                <ion-icon name="time-outline"></ion-icon>
                <ion-label>{{ calculateSimpleDuration(day.opening, day.closing) }} d'ouverture</ion-label>
              </ion-chip>
            </div>
          </div>

          <!-- Indicateur ferm√© -->
          <div *ngIf="!day.isOpen" class="closed-indicator">
            <ion-icon name="bed" color="medium"></ion-icon>
            <span>Jour de fermeture</span>
          </div>
          
        </div>
        
      </div>

      <!-- Bouton de sauvegarde -->
      <div class="form-actions" style="margin-top: 24px;">
        <ion-button expand="block" fill="solid" color="success" (click)="onSaveSimpleBusinessHours()">
          <ion-icon name="save" slot="start"></ion-icon>
          Sauvegarder les horaires
        </ion-button>
      </div>
      
    </ion-card-content>
  </ion-card>

  <!-- Bot Configuration - MASQU√â -->
  <ion-card class="main-content-card" style="display: none;">
    <ion-card-header>
      <ion-card-title>
        <ion-icon name="chatbubbles" color="tertiary"></ion-icon>
        Configuration Bot WhatsApp
      </ion-card-title>
    </ion-card-header>
    
    <ion-card-content>
      <form [formGroup]="botForm">
        
        <ion-item fill="outline">
          <ion-label position="stacked">Nom de marque *</ion-label>
          <ion-input formControlName="brand_name" type="text"></ion-input>
        </ion-item>

        <ion-item fill="outline">
          <ion-label position="stacked">Message de bienvenue *</ion-label>
          <ion-textarea formControlName="welcome_message" rows="3"></ion-textarea>
        </ion-item>


        <div class="form-actions">
          <ion-button expand="block" fill="solid" color="tertiary" (click)="onSaveBotConfig()">
            <ion-icon name="chatbubbles" slot="start"></ion-icon>
            Sauvegarder la configuration bot
          </ion-button>
        </div>
      </form>
    </ion-card-content>
  </ion-card>

</div>